<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AI Bot Status</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #1f1c2c, #928dab);
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      animation: fadeIn 1.2s ease;
    }
    @keyframes fadeIn {
      from {opacity: 0; transform: translateY(20px);}
      to {opacity: 1; transform: translateY(0);}
    }
    h1 {
      font-size: 3rem;
      margin-bottom: 1rem;
    }
    .status {
      font-size: 2rem;
      margin: 1rem;
    }
    .uptime {
      font-size: 1.2rem;
    }
    .login-form {
      margin-top: 2rem;
      background: rgba(0,0,0,0.3);
      padding: 20px;
      border-radius: 12px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      width: 300px;
      animation: fadeIn 1.5s ease;
    }
    input, button {
      padding: 10px;
      font-size: 1rem;
      border: none;
      border-radius: 6px;
    }
    button {
      background: #5b5aa2;
      color: white;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover {
      background: #7b7acf;
    }
    .admin-panel {
      margin-top: 2rem;
      text-align: center;
    }
  </style>
</head>
<body>
  <h1>ü§ñ AI Bot Status</h1>
  <div class="status" id="bot-status">Loading...</div>
  <div class="uptime" id="uptime-info"></div>

  <form class="login-form" id="login-form">
    <input type="text" name="username" placeholder="Admin Username" required />
    <input type="password" name="password" placeholder="Admin Password" required />
    <button type="submit">Login</button>
    <div id="login-error" style="color: red; display: none;">Invalid credentials</div>
  </form>

  <div class="admin-panel" id="admin-panel" style="display: none;">
    <h2>üõ†Ô∏è Admin Dashboard</h2>
    <p id="uptime-detail"></p>
    <p id="downtime-detail"></p>
  </div>

  <script>
    const statusEl = document.getElementById('bot-status');
    const uptimeInfoEl = document.getElementById('uptime-info');
    const adminPanel = document.getElementById('admin-panel');
    const uptimeDetail = document.getElementById('uptime-detail');
    const downtimeDetail = document.getElementById('downtime-detail');

    function formatTime(ms) {
      const totalSec = Math.floor(ms / 1000);
      const h = String(Math.floor(totalSec / 3600)).padStart(2, '0');
      const m = String(Math.floor((totalSec % 3600) / 60)).padStart(2, '0');
      const s = String(totalSec % 60).padStart(2, '0');
      return `${h}:${m}:${s}`;
    }

    async function fetchStatus() {
      const res = await fetch('/bot-status');
      const data = await res.json();
      statusEl.textContent = data.online ? 'üü¢ Online' : 'üî¥ Offline';
      uptimeInfoEl.textContent = data.online 
        ? `Uptime: ${formatTime(data.uptime)}`
        : `Downtime: ${formatTime(data.downtime)}`;
      if (adminPanel.style.display === 'block') {
        uptimeDetail.textContent = `Online for: ${formatTime(data.uptime)}`;
        downtimeDetail.textContent = `Offline for: ${formatTime(data.downtime)}`;
      }
    }

    fetchStatus();
    setInterval(fetchStatus, 5000);

    const form = document.getElementById('login-form');
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const formData = new FormData(form);
      const res = await fetch('/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          username: formData.get('username'),
          password: formData.get('password'),
        }),
      });
      if (res.ok) {
        form.style.display = 'none';
        adminPanel.style.display = 'block';
        fetchStatus();
      } else {
        document.getElementById('login-error').style.display = 'block';
      }
    });
  </script>
</body>
</html>
